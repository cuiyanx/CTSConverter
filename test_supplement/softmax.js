describe('CTS Supplement Test', function() {
  const assert = chai.assert;
  const nn = navigator.ml.getNeuralNetworkContext();

  it('check result for Softmax with 2D input tensor example', async function() {
    const model = await nn.createModel(options);
    const float32TensorType = {type: nn.TENSOR_FLOAT32, dimensions: [2, 2]};
    const tensorLength = product(float32TensorType.dimensions);

    model.addOperand(float32TensorType);
    model.addOperand({type: nn.FLOAT32});
    model.setOperandValue(1, new Float32Array([1.0]));
    model.addOperand(float32TensorType);
    model.addOperation(nn.SOFTMAX, [0, 1], [2]);

    model.identifyInputsAndOutputs([0], [2]);
    await model.finish();

    const compilation = await model.createCompilation();
    compilation.setPreference(getPreferenceCode(options.prefer));
    await compilation.finish();

    const execution = await compilation.createExecution();

    const inputData0 = new Float32Array(tensorLength);
    inputData0.set([1.0, 1.0, 1.0, 1.0]);
    execution.setInput(0, inputData0);

    const outputData = new Float32Array(tensorLength);
    execution.setOutput(0, outputData);

    await execution.startCompute();
    const expectedData = new Float32Array(tensorLength);
    expectedData.set([0.5, 0.5, 0.5, 0.5]);

    for (let i = 0; i < tensorLength; ++i) {
      assert.isTrue(almostEqualCTS(outputData[i], expectedData[i]));
    }
  });

  it('check result for Softmax float with 4D input tensor example-1', async function() {
    const model = await nn.createModel(options);
    let operandIndex = 0;
    const input_value = [10.63, 18.75, 12.91, 9.46, 7.31, 12.48, 9.55, 14.28];
    const output_expect = [0.0002926, 0.9835261, 0.0028609, 0.0000908, 0.0000106, 0.0018611, 0.0000994, 0.0112587];

    const type1 = {type: nn.FLOAT32};
    const type0 = {type: nn.TENSOR_FLOAT32, dimensions: [1, 1, 1, 8]};
    const type0_length = product(type0.dimensions);

    const input = operandIndex++;
    model.addOperand(type0);
    const beta = operandIndex++;
    model.addOperand(type1);
    const output = operandIndex++;
    model.addOperand(type0);

    model.setOperandValue(beta, new Float32Array([1.0]));
    model.addOperation(nn.SOFTMAX, [input, beta], [output]);

    model.identifyInputsAndOutputs([input], [output]);
    await model.finish();

    const compilation = await model.createCompilation();
    compilation.setPreference(getPreferenceCode(options.prefer));
    await compilation.finish();

    const execution = await compilation.createExecution();

    const input_input = new Float32Array(input_value);
    execution.setInput(0, input_input);

    const output_output = new Float32Array(type0_length);
    execution.setOutput(0, output_output);

    await execution.startCompute();

    for (let i = 0; i < type0_length; ++i) {
      assert.isTrue(almostEqualCTS(output_output[i], output_expect[i]));
    }
  });

  it('check result for Softmax float with 4D input tensor example-2', async function() {
    const model = await nn.createModel(options);
    let operandIndex = 0;
    const input_value = [10.63, 18.75, 12.91, 9.46, 7.31, 12.48, 9.55, 14.28, 19.07, 15.91, 18.47, 20.08];
    const output_expect = [0.000296, 0.9948254, 0.0028938, 0.0000919, 0.0000107, 0.0018824, 0.0000169, 0.001913, 0.2301376, 0.0097638, 0.1263021, 0.6318661];

    const type1 = {type: nn.FLOAT32};
    const type0 = {type: nn.TENSOR_FLOAT32, dimensions: [1, 1, 2, 6]};
    const type0_length = product(type0.dimensions);

    const input = operandIndex++;
    model.addOperand(type0);
    const beta = operandIndex++;
    model.addOperand(type1);
    const output = operandIndex++;
    model.addOperand(type0);

    model.setOperandValue(beta, new Float32Array([1.0]));
    model.addOperation(nn.SOFTMAX, [input, beta], [output]);

    model.identifyInputsAndOutputs([input], [output]);
    await model.finish();

    const compilation = await model.createCompilation();
    compilation.setPreference(getPreferenceCode(options.prefer));
    await compilation.finish();

    const execution = await compilation.createExecution();

    const input_input = new Float32Array(input_value);
    execution.setInput(0, input_input);

    const output_output = new Float32Array(type0_length);
    execution.setOutput(0, output_output);

    await execution.startCompute();

    for (let i = 0; i < type0_length; ++i) {
      assert.isTrue(almostEqualCTS(output_output[i], output_expect[i]));
    }
  });

  it('check result for Softmax float with 4D input tensor example-3', async function() {
    const model = await nn.createModel(options);
    let operandIndex = 0;
    const input_value = [
      10.633096694946289, 18.750228881835938, 12.917834281921387, 9.46863079071045, 7.316360950469971, 12.48576545715332, 9.552565574645996, 14.280917167663574, 19.07547378540039, 15.915868759155273, 18.47535514831543, 20.08603286743164, 19.306753158569336, 16.763883590698242, 17.23187828063965, 13.828563690185547, 16.604629516601562, 15.456416130065918, 12.026884078979492, 17.517009735107422, 13.086971282958984, 17.17919158935547, 13.359915733337402, 18.612995147705078, 15.037846565246582, 12.749266624450684, 20.888051986694336, 19.03054428100586, 12.739729881286621, 20.859451293945312, 9.963472366333008, 17.446157455444336, 13.153258323669434, 10.8407621383667, 7.386678695678711, 12.040700912475586, 14.887235641479492, 8.948171615600586, 14.241692543029785, 13.147953987121582, 19.639558792114258, 16.8834171295166, 20.867238998413086, 15.453288078308105, 15.594100952148438, 8.695173263549805, 19.68443489074707, 20.516754150390625, 12.195821762084961, 7.397640705108643, 10.379465103149414, 7.701779842376709, 14.675374984741211, 12.548005104064941, 13.878507614135742, 10.712503433227539, 10.09022331237793, 9.910835266113281, 13.521472930908203, 11.991893768310547, 10.604318618774414, 13.52990436553955, 12.962638854980469, 10.640522956848145, 11.012723922729492, 10.303203582763672, 17.868167877197266, 12.640779495239258, 16.51861572265625, 8.668283462524414, 14.46950626373291, 11.660629272460938, 13.119953155517578, 20.012876510620117, 17.966630935668945, 14.317724227905273, 10.995388984680176, 21.0853271484375, 20.428958892822266, 14.6182279586792, 16.351455688476562, 13.798954010009766, 18.01214027404785, 16.112661361694336, 16.145004272460938, 21.265243530273438, 19.746318817138672, 15.0040922164917, 18.015207290649414, 13.846283912658691, 14.229297637939453, 21.80757713317871, 20.887664794921875, 17.63591766357422, 21.04983139038086, 18.448760986328125, 15.622299194335938, 13.906994819641113, 10.934183120727539, 17.315757751464844, 13.339083671569824, 4.85207986831665, 13.862253189086914, 17.0489559173584, 17.090391159057617, 19.222625732421875, 18.432119369506836, 12.8416748046875, 13.289155960083008, 5.505262851715088, 14.440519332885742, 11.779170036315918, 13.61559772491455, 17.74374008178711, 15.418974876403809, 16.40049934387207, 10.327967643737793, 10.13575267791748, 8.87507438659668, 11.005951881408691, 15.417574882507324, 9.246169090270996, 11.587608337402344, 7.928442001342773, 12.507555961608887, 14.174178123474121, 14.090804100036621, 12.676902770996094, 12.651900291442871, 12.657724380493164, 14.737821578979492, 10.923689842224121, 10.040297508239746, 14.572811126708984, 18.230188369750977, 14.233528137207031, 17.16696548461914, 12.539831161499023, 17.216655731201172, 10.261114120483398, 15.773637771606445, 9.769366264343262, 8.743120193481445, 7.953049659729004, 16.061744689941406, 12.244834899902344, 9.669194221496582, 6.421072006225586, 7.566117286682129, 10.127528190612793, 16.603940963745117, 23.608600616455078, 18.561338424682617, 18.106245040893555, 16.091753005981445, 14.153021812438965, 11.953116416931152, 17.563020706176758, 17.049118041992188, 9.418050765991211, 9.063760757446289, 5.397731781005859, 11.469522476196289, 5.9847636222839355, 5.454802989959717, 5.276651859283447, 8.385995864868164, 10.397110939025879, 9.794140815734863, 7.765122413635254, 9.706226348876953, 12.75146484375, 11.481279373168945, 15.583362579345703, 12.664912223815918, 12.48148250579834, 9.0400972366333, 10.423805236816406, 9.941632270812988, 14.847150802612305, 11.887077331542969, 13.975244522094727, 18.85527801513672, 15.132763862609863, 15.222917556762695, 21.931215286254883, 22.93506622314453, 16.561208724975586, 15.666217803955078, 16.318681716918945, 10.93188762664795, 9.766206741333008, 18.415191650390625, 15.500444412231445, 13.569294929504395, 14.135770797729492, 15.194920539855957, 9.175687789916992, 12.3844633102417, 12.382109642028809, 14.051812171936035, 13.496564865112305, 16.24966049194336, 18.620302200317383, 17.311433792114258, 11.768840789794922, 10.057878494262695, 16.888906478881836, 13.056600570678711, 10.114962577819824, 6.360996723175049, 13.598278999328613, 10.554468154907227, 10.785820960998535, 11.084970474243164, 13.954259872436523, 9.376203536987305, 9.118735313415527, 9.517805099487305, 13.780681610107422, 10.723291397094727, 9.961705207824707, 13.04687213897705, 16.338111877441406, 14.786600112915039, 10.975630760192871, 7.872645854949951, 12.923849105834961, 8.248885154724121, 8.072661399841309, 13.284008979797363, 17.742828369140625, 19.021516799926758, 12.659760475158691, 10.832762718200684, 12.244898796081543, 9.773988723754883, 11.93078327178955, 9.257373809814453, 12.855767250061035, 11.640983581542969, 6.922642230987549, 10.941132545471191, 6.090719223022461, 9.144007682800293, 14.85858154296875, 5.732938289642334, 7.951379776000977, 22.1893253326416, 18.594200134277344, 19.11495018005371, 9.753591537475586, 17.731361389160156, 16.950284957885742, 12.792081832885742, 8.655010223388672, 11.664034843444824, 13.184113502502441, 17.379167556762695, 21.497314453125, 18.083168029785156, 13.747838973999023, 16.312685012817383, 22.464080810546875, 17.72537612915039, 21.2579402923584, 19.709409713745117, 17.889324188232422, 12.99542236328125, 19.886795043945312, 19.78012466430664, 18.930387496948242, 20.853300094604492, 20.380077362060547, 20.485424041748047, 11.897425651550293, 21.703922271728516, 25.7706298828125, 25.417396545410156, 22.408151626586914, 21.254987716674805, 21.25147247314453, 24.951309204101562, 19.646259307861328, 15.995959281921387, 20.60489273071289, 22.796550750732422, 25.586605072021484, 17.506654739379883, 18.077157974243164, 17.154869079589844, 16.19427490234375, 19.657270431518555, 22.114973068237305, 22.831348419189453, 16.289579391479492, 16.08236312866211, 12.500151634216309, 27.87720489501953, 22.74942398071289, 11.590218544006348, 23.27147102355957, 15.392729759216309, 16.297754287719727, 19.246252059936523, 13.171932220458984, 18.263992309570312, 19.38363265991211, 16.606826782226562, 21.869565963745117, 21.531877517700195, 14.4906644821167, 17.118247985839844, 13.3585786819458, 13.36583137512207, 14.172847747802734, 14.482640266418457, 20.355361938476562, 22.65353012084961, 20.236610412597656, 22.6688232421875, 12.264982223510742, 22.149799346923828, 10.919144630432129, 16.730859756469727, 18.9865779876709, 17.438749313354492, 12.164246559143066, 9.182199478149414, 13.177031517028809, 16.747133255004883, 22.318220138549805, 16.13444709777832, 31.314706802368164, 14.171764373779297, 20.046432495117188, 19.96190071105957, 19.90066909790039, 19.768455505371094, 9.5852689743042, 14.080363273620605, 18.218555450439453, 16.570444107055664, 11.141199111938477, 8.320511817932129, 9.214081764221191, 6.724745273590088, 10.460344314575195, 10.91906452178955, 10.70103645324707, 8.582121849060059, 5.750553131103516, 8.196184158325195, 11.705013275146484, 11.400447845458984, 15.86993408203125, 29.46346664428711, 28.481582641601562, 30.271581649780273, 27.074277877807617, 23.513687133789062, 14.259750366210938, 22.21346664428711, 10.838545799255371, 13.458712577819824, 14.445221900939941, 10.288758277893066, 9.76822566986084, 16.683469772338867, 15.019920349121094, 17.477670669555664, 21.0462646484375, 11.625995635986328, 17.343097686767578, 20.955812454223633, 14.320205688476562, 13.160045623779297, 23.845062255859375, 17.921173095703125, 18.691030502319336, 25.263710021972656, 23.509864807128906, 21.79447364807129, 17.10430908203125, 20.87082290649414, 6.691738128662109, 4.533743858337402, 32.7180290222168, 14.728958129882812, 12.593729019165039, 11.756786346435547, 12.521442413330078, 13.999703407287598, 7.966588020324707, 7.5634331703186035, 12.278633117675781, 8.848836898803711, 21.33017349243164, 15.9844331741333, 9.855817794799805, 7.322624206542969, 9.465375900268555, 9.09567928314209, 5.431189060211182, 11.508605003356934, 9.423563003540039, 5.644067287445068, 9.203815460205078, 6.727909564971924, 12.500838279724121, 8.945449829101562, 7.68461275100708, 11.250411033630371, 7.7577900886535645, 7.69315242767334, 18.22950553894043, 11.466642379760742, 11.124119758605957, 17.135154724121094, 20.294755935668945, 7.910463333129883, 12.207856178283691, 10.171067237854004, 11.036746978759766, 15.994007110595703, 9.576361656188965, 10.139100074768066, 11.252339363098145, 19.56910514831543, 15.305747985839844, 8.877645492553711, 10.725064277648926, 11.874349594116211, 7.23990535736084, 23.156518936157227, 12.889435768127441, 7.595884799957275, 12.746710777282715, 15.353927612304688, 13.408821105957031, 15.109270095825195, 12.982090950012207, 8.926817893981934, 20.238067626953125, 5.082365989685059, 9.151376724243164, 14.556602478027344, 14.110031127929688, 12.146501541137695, 9.675328254699707, 11.475993156433105, 10.607942581176758, 20.15665626525879, 16.725154876708984, 14.798490524291992, 14.677826881408691, 17.104942321777344, 22.826847076416016, 6.6239824295043945, 11.857154846191406, 11.215736389160156, 9.413376808166504, 13.951075553894043, 20.70792007446289, 13.43892765045166, 7.521987438201904, 8.435393333435059, 7.710779190063477, 7.7452778816223145, 11.229757308959961, 18.31511878967285, 12.494784355163574, 7.136443614959717, 13.607855796813965, 11.863105773925781, 15.43836784362793, 10.102659225463867, 9.572657585144043, 20.003894805908203, 7.735821723937988, 10.727670669555664, 14.5988187789917, 8.454527854919434, 13.764562606811523, 9.13848876953125, 11.05479621887207, 7.651605129241943, 19.541263580322266, 13.013172149658203, 18.636497497558594, 8.763279914855957, 10.759872436523438, 5.887054920196533, 6.702114582061768, 14.914555549621582, 7.584196090698242, 18.391887664794922, 11.342570304870605, 16.591960906982422, 9.99575138092041, 2.692444086074829, 11.62830924987793, 12.326775550842285, 10.393973350524902, 18.7794246673584, 11.606731414794922, 16.985645294189453, 12.819670677185059, 22.42898178100586, 17.77494239807129, 7.2856574058532715, 5.674855709075928, 16.14600944519043, 9.735804557800293, 7.700339317321777, 16.8890323638916, 12.788625717163086, 8.340590476989746, 9.897276878356934, 12.495906829833984, 16.799942016601562, 11.413158416748047, 12.565237998962402, 13.016317367553711, 6.6281514167785645, 8.394243240356445, 11.428860664367676, 12.286535263061523, 12.476916313171387, 13.393653869628906, 18.071990966796875, 13.326603889465332, 14.388191223144531, 16.641151428222656, 20.775880813598633, 8.633672714233398, 6.971398830413818, 15.458163261413574, 9.286026000976562, 20.402040481567383, 6.572159290313721, 11.029325485229492, 15.130033493041992, 19.171951293945312, 8.491789817810059, 13.256662368774414, 10.625027656555176, 4.617883682250977, 9.81132698059082, 14.932689666748047, 8.410503387451172, 11.563192367553711, 15.107598304748535, 8.680805206298828, 7.17470121383667, 10.41996955871582, 10.600149154663086, 11.872647285461426, 11.262316703796387, 13.336587905883789, 6.557470321655273, 6.086480140686035, 17.123538970947266, 12.54118537902832, 6.883083820343018, 7.150421619415283, 11.645964622497559, 12.30489444732666, 11.739986419677734, 7.104118347167969, 13.120207786560059, 7.805128574371338, 15.813161849975586, 5.132405757904053, 11.732964515686035, 12.729701042175293, 7.854181289672852, 10.323857307434082, 10.044418334960938, 7.791658878326416, 12.905342102050781, 6.566869735717773, 16.58338165283203, 6.539013385772705, 19.956323623657227, 15.6813325881958, 6.952506065368652, 15.236894607543945, 19.901325225830078, 12.898874282836914, 13.024730682373047, 15.449207305908203, 13.418533325195312, 13.35937213897705, 6.902468204498291, 9.149248123168945, 12.655171394348145, 6.908873081207275, 7.920547962188721, 18.209186553955078, 16.290029525756836, 8.436335563659668, 15.455425262451172, 10.462504386901855, 11.550963401794434, 14.850924491882324, 14.157072067260742, 6.95953369140625, 13.412869453430176, 9.158906936645508, 7.781056880950928, 16.6036434173584, 4.808084964752197, 16.464162826538086, 8.920628547668457, 7.468282222747803, 15.928406715393066, 10.48175048828125, 15.1595458984375, 16.93899154663086, 20.6048641204834, 10.1943998336792, 23.46732521057129, 14.569906234741211, 13.991246223449707, 9.545177459716797, 14.73549747467041, 4.1087470054626465, 8.822433471679688, 10.808523178100586, 6.976772785186768, 13.555315017700195, 11.995615005493164, 17.68769645690918, 7.434670448303223, 11.686838150024414, 11.780466079711914, 13.016263008117676, 11.471842765808105, 8.670991897583008, 6.094179630279541, 13.375377655029297, 4.240854263305664, 14.909464836120605, 16.622299194335938, 12.553129196166992, 4.400779724121094, 14.271684646606445, 15.330678939819336, 5.092896938323975, 17.178447723388672, 11.311455726623535, 8.151897430419922, 13.499678611755371, 8.588479042053223, 9.777791976928711, 6.631325721740723, 7.920196056365967, 18.568910598754883, 11.4961519241333, 9.567403793334961, 3.42606520652771, 13.4708833694458, 7.893254280090332, 16.88814926147461, 7.639266014099121, 11.274413108825684, 12.329423904418945, 5.295083045959473, 8.608922004699707, 11.687641143798828, 5.501578330993652, 8.556900978088379, 22.424365997314453, 21.320537567138672, 9.413985252380371, 16.24306297302246, 18.76443862915039, 12.455265998840332, 9.97346305847168, 19.657798767089844, 19.776670455932617, 14.17664909362793, 13.859002113342285, 11.102787971496582, 5.418384552001953, 13.521247863769531, 5.904786586761475, 11.003355979919434, 9.2664155960083, 10.399650573730469, 8.900339126586914, 18.227764129638672, 11.308398246765137, 8.56893253326416, 15.272917747497559, 21.683618545532227, 8.110478401184082, 8.979012489318848, 14.438859939575195, 23.816020965576172, 10.164922714233398, 12.940319061279297, 15.51875114440918, 14.825761795043945, 9.596190452575684, 8.136138916015625, 12.112674713134766, 8.235942840576172, 14.2014799118042, 15.066385269165039, 14.520268440246582, 15.384756088256836, 15.410542488098145, 13.188827514648438, 8.248003005981445, 20.823171615600586, 5.83102560043335, 8.386247634887695, 15.35638427734375, 12.13347053527832, 12.067032814025879, 23.452890396118164, 17.4442195892334, 6.897007465362549, 16.249801635742188, 7.627880573272705, 8.791763305664062, 18.85394859313965, 11.848384857177734, 7.161445617675781, 14.167245864868164, 9.618569374084473, 13.03767204284668, 4.883429527282715, 12.788015365600586, 9.504534721374512, 16.950599670410156, 17.135223388671875, 5.525537014007568, 11.9367036819458, 8.002015113830566, 19.02523422241211, 9.852280616760254, 10.827128410339355, 6.175796985626221, 7.862109184265137, 10.792503356933594, 14.547138214111328, 19.57797622680664, 10.705717086791992, 5.619636535644531, 12.487151145935059, 12.44333553314209, 13.876189231872559, 8.839409828186035, 8.618517875671387, 7.086108684539795, 13.258471488952637, 8.735761642456055, 15.709990501403809, 23.941495895385742, 14.898078918457031, 11.989447593688965, 9.777897834777832, 15.606669425964355, 8.85151481628418, 20.076242446899414, 10.302022933959961, 19.189739227294922, 10.508451461791992, 9.3486328125, 16.8221378326416, 23.214120864868164, 7.9513139724731445, 9.37641716003418, 10.079035758972168, 10.692888259887695, 15.500971794128418, 8.896175384521484, 7.747472763061523, 11.700419425964355, 17.939682006835938, 16.658222198486328, 18.93973159790039, 14.567663192749023, 9.807376861572266, 10.250672340393066, 11.922234535217285, 9.841506004333496, 17.176061630249023, 15.122502326965332, 11.642127990722656, 9.288005828857422, 17.532371520996094, 11.409940719604492, 10.133581161499023, 17.396413803100586, 10.805451393127441, 13.814460754394531, 10.8898344039917, 6.822375297546387, 7.756640911102295, 5.883997917175293, 18.50943374633789, 15.444413185119629, 13.512382507324219, 10.010627746582031, 13.188455581665039, 16.911428451538086, 14.24902629852295, 17.83585548400879, 7.323952674865723, 17.830869674682617, 10.343512535095215, 15.469857215881348, 14.64986515045166, 4.747836589813232, 14.0709810256958, 14.859786033630371, 11.047195434570312, 6.187945365905762, 6.384342193603516, 15.852181434631348, 17.95515251159668, 13.279470443725586, 15.942207336425781, 12.031232833862305, 17.550067901611328, 9.142046928405762, 7.987494468688965, 10.954753875732422, 9.919310569763184, 6.418801307678223, 9.850926399230957, 12.471698760986328, 14.544173240661621, 14.931924819946289, 13.729412078857422, 7.002838611602783, 18.513202667236328, 14.387741088867188, 6.659890174865723, 12.94911003112793, 15.653473854064941, 20.65776252746582, 11.097545623779297, 8.67094612121582, 11.96640682220459, 14.012194633483887, 23.167497634887695, 12.37126350402832, 22.66785430908203, 10.08847427368164, 7.214731693267822, 20.058713912963867, 11.182188987731934, 8.85742473602295, 10.458805084228516, 15.855852127075195, 12.43456745147705, 17.035202026367188, 14.466036796569824, 7.409712791442871, 4.4751296043396, 17.218917846679688, 10.063966751098633, 10.104472160339355, 13.607396125793457, 6.362962245941162, 13.306111335754395, 4.225671768188477, 16.492111206054688, 10.005599975585938, 3.6910488605499268, 8.502364158630371, 17.432174682617188, 7.754965782165527, 13.66734504699707, 18.698524475097656, 9.998183250427246, 10.519367218017578, 10.32975959777832, 16.7487735748291, 11.253996849060059, 19.485973358154297, 8.824007987976074, 6.66616153717041, 5.742675304412842, 10.295378684997559, 10.892179489135742, 8.883288383483887, 12.90867805480957, 11.247989654541016, 6.21877908706665, 11.02491569519043, 18.458473205566406, 17.864404678344727, 19.68421745300293, 15.547470092773438, 10.0148344039917, 11.02116584777832, 18.050172805786133, 14.298063278198242, 23.68663787841797, 14.349076271057129, 8.816232681274414, 13.859445571899414, 9.727208137512207, 14.893916130065918, 22.43604850769043, 17.441837310791016, 19.600698471069336, 7.264801502227783, 2.443992853164673, 4.433985233306885, 15.922985076904297, 11.761265754699707, 16.840246200561523, 10.411992073059082, 5.234299659729004, 12.049160957336426, 12.798580169677734, 15.829668045043945, 14.996968269348145, 16.621143341064453, 8.305027961730957, 10.319125175476074, 11.589641571044922, 24.855915069580078, 11.700460433959961, 10.665645599365234, 6.567962646484375, 8.83480167388916, 13.192261695861816, 13.800191879272461, 10.726040840148926, 23.260066986083984, 14.184962272644043, 15.241336822509766, 12.362273216247559, 9.456809997558594, 15.895992279052734, 17.549957275390625, 13.98581600189209, 18.19790267944336, 12.856616020202637, 22.54080581665039, 20.437210083007812, 18.296781539916992, 20.601491928100586, 17.888147354125977, 21.95772933959961, 17.490028381347656, 19.035091400146484, 10.328767776489258, 17.410137176513672, 15.300915718078613, 15.674595832824707, 7.31687593460083, 6.946949005126953, 11.746861457824707, 10.91621208190918, 10.711849212646484, 17.64960289001465, 16.84800910949707, 13.10483455657959, 10.787004470825195, 19.537708282470703, 13.479764938354492, 10.648937225341797, 20.14699363708496, 7.483791351318359, 12.170218467712402, 11.080985069274902, 18.158065795898438, 6.356677055358887, 9.530189514160156, 13.072765350341797, 5.075244903564453, 10.3015718460083, 10.833891868591309, 12.011783599853516, 5.759989261627197, 18.32382583618164, 21.10507583618164, 10.329180717468262, 24.04796600341797, 18.622648239135742, 18.175914764404297, 20.407981872558594, 11.882205963134766, 16.208574295043945, 9.092352867126465, 13.63718318939209, 15.504472732543945, 15.205802917480469, 14.812711715698242, 25.147401809692383, 18.61565399169922,
    ];
    const output_expect = [
      1.8249300681727476e-10, 6.116051167737169e-7, 1.7926399253909153e-9, 5.695406299355277e-11, 6.619194775625559e-12, 1.1637220076465837e-9, 6.194108420620736e-11, 7.006050850577594e-9, 8.466907956972136e-7, 3.593595110373826e-8, 4.646186653189943e-7, 0.0000023259663066710345, 0.0000010670113397281966, 8.39102085592458e-8, 1.3398664577835007e-7, 4.456800706265085e-9, 7.155678360959428e-8, 2.2698046109326242e-8, 7.354650777280369e-10, 1.781944547474268e-7, 2.123014208876839e-9, 1.271098142296978e-7, 2.789265929337148e-9, 5.331788770490675e-7, 1.4935055858700252e-8, 1.5145609211231204e-9, 0.000005187015631236136, 8.094943950709421e-7, 1.500185531355669e-9, 0.000005040726136940066, 9.341904333437512e-11, 1.6600490937435097e-7, 2.268513821235274e-9, 2.2461242588089902e-10, 7.101400197051522e-12, 7.456959494334114e-10, 1.2846859576143288e-8, 3.38449754333503e-11, 6.736574409416107e-9, 2.2565083135361874e-9, 0.0000014883429457768216, 9.456402239038653e-8, 0.000005080212758912239, 2.2627158813293136e-8, 2.604856774723885e-8, 2.6279480327962013e-11, 0.0000015566582760584424, 0.00000357821659235924, 8.708197496432035e-10, 7.179711252608412e-12, 1.4161076478114154e-10, 9.73176747520732e-12, 1.0394024307913696e-8, 1.2384566705492261e-9, 4.685007493065996e-9, 1.9757658009655898e-10, 1.0604274403025471e-10, 8.862839628864805e-11, 3.278344262724886e-9, 7.101745858051345e-10, 1.7731742463222844e-10, 3.3060865156642194e-9, 1.874797650458504e-9, 1.8385312716695523e-10, 2.667577825299361e-10, 1.3121283226613656e-10, 2.5316251139884116e-7, 1.3588561387223308e-9, 6.565893784227228e-8, 2.558234353522426e-11, 8.460118827713359e-9, 5.099181077383719e-10, 2.1941859440488543e-9, 0.0000021618986920657335, 2.793586872940068e-7, 7.268775803481731e-9, 2.621741435060443e-10, 0.0000063181955738400575, 0.0000032774305509519763, 9.816756296743279e-9, 5.5551996780422996e-8, 4.326729641235261e-9, 2.923641773122654e-7, 4.3751381184620186e-8, 4.5189647579491066e-8, 0.0000075636212386598345, 0.0000016560430822210037, 1.4439318185566208e-8, 2.9326221806513786e-7, 4.536449882408533e-9, 6.653596340555623e-9, 0.000013009574104216881, 0.000005184987912798533, 2.0069361994501378e-7, 0.000006097848654462723, 4.5242711621540366e-7, 2.6793543383973883e-8, 4.820421395379526e-9, 2.466070958551114e-10, 1.4571017459275026e-7, 2.731750603501837e-9, 5.630991007678221e-13, 4.609471027094969e-9, 1.1158847001979666e-7, 1.1630885410340852e-7, 9.809130006033229e-7, 4.4496027840068564e-7, 1.6611939601673953e-9, 2.5987216822898063e-9, 1.0820738836209154e-12, 8.21843038067982e-9, 5.740911079854527e-10, 3.6018896754086427e-9, 2.235442906339813e-7, 2.1863918675535388e-8, 5.8344269859844644e-8, 1.3450288105509856e-10, 1.1098229280026572e-10, 3.145914084790036e-11, 2.6495813876259433e-10, 2.1833246321989463e-8, 4.559458713360165e-11, 4.740103864975254e-10, 1.2207628137528292e-11, 1.189361720221882e-9, 6.296795529436849e-9, 5.793106883089649e-9, 1.4088370470233258e-9, 1.3740559801078689e-9, 1.3820726785240822e-9, 1.1063875149375235e-8, 2.4403454257360124e-10, 1.008783681588632e-10, 9.380873855491245e-9, 3.635971097537549e-7, 6.681817321663175e-9, 1.2556522221984778e-7, 1.2283783989985864e-9, 1.319624658435714e-7, 1.2580547714691193e-10, 3.117129665497487e-8, 7.693680414977422e-11, 2.7570249902519883e-11, 1.2511791082359114e-11, 4.157962862905151e-8, 9.145715851310854e-10, 6.960345494411158e-11, 2.7038681623542393e-12, 8.49717171624853e-12, 1.1007285360964403e-10, 7.150657665988547e-8, 0.00007878302858443931, 5.063358798906847e-7, 3.2121070603352564e-7, 4.284635224394151e-8, 6.164954768905773e-9, 6.831636922832729e-10, 1.8658418809991417e-7, 1.1160614121763501e-7, 5.414501833000962e-11, 3.799215803068634e-11, 9.717554452087773e-13, 4.212125648273002e-10, 1.7478408043808402e-12, 1.0288263296853728e-12, 8.609374606456666e-13, 1.9290504957303334e-11, 1.4413163718085542e-10, 7.886622604980076e-11, 1.0368188946285883e-11, 7.222899361947199e-11, 1.5178924783754155e-9, 4.261972164076866e-10, 2.5770294342919442e-8, 1.3920411490175866e-9, 1.158753981655991e-9, 3.710357715513979e-11, 1.4803136494379032e-10, 9.140060930334926e-11, 1.2342080246696696e-8, 6.395098894884654e-10, 5.160866400899522e-9, 6.793536044824577e-7, 1.642214009223153e-8, 1.7971462540344874e-8, 0.00001472174517402891, 0.00004017187166027725, 6.851595912849007e-8, 2.799650111739993e-8, 5.3760949469960906e-8, 2.460428250028457e-10, 7.66941718466363e-11, 4.37488182569723e-7, 2.3719570307889626e-8, 3.4389011638324973e-9, 6.0595204409708e-9, 1.7475176861125874e-8, 4.2491617863182896e-11, 1.051609910263096e-9, 1.049139664033305e-9, 5.5715374536191575e-9, 3.1976714609527335e-9, 5.017546556018715e-8, 5.370870326260047e-7, 1.4508121637391014e-7, 5.681911607879897e-10, 1.0266749256304664e-10, 9.508508469480148e-8, 2.0594983496380337e-9, 1.0869920241685094e-10, 2.546228635921799e-12, 3.5400531395168855e-9, 1.6869379504402815e-10, 2.126052528472755e-10, 2.867427961739111e-10, 5.053676588318012e-9, 5.192605373460779e-11, 4.013919752132722e-11, 5.982467993215224e-11, 4.248412288632153e-9, 1.9971842235566584e-10, 9.325347438693399e-11, 2.0395654054539136e-9, 5.481511777816195e-8, 1.1616889672438901e-8, 2.5704485762112483e-10, 1.1545171069160531e-11, 1.8034636006802884e-9, 1.681890043903067e-11, 1.410142228680522e-11, 2.5853830187827498e-9, 2.2333928484385979e-7, 8.022150836950459e-7, 1.384896197720309e-9, 2.228236761769864e-10, 9.146239321466965e-10, 7.729304002390691e-11, 6.68074318088685e-10, 4.610838100216341e-11, 1.6847684358722859e-9, 4.999962666119018e-10, 4.464962254091542e-12, 2.4832849665479273e-10, 1.9432077474901277e-12, 4.1166538927717156e-11, 1.2483943656604879e-8, 1.358734739304035e-12, 1.2490904144346615e-11, 0.000019056877135881223, 5.232483886175032e-7, 8.807802487353911e-7, 7.573230931257058e-11, 2.2079163386479195e-7, 1.0110312587130466e-7, 1.5808230280356383e-9, 2.524497971778672e-11, 5.116571610841447e-10, 2.3395780868185057e-9, 1.552485571210127e-7, 0.000009539289749227464, 3.1388600518766907e-7, 4.1111416493322395e-9, 5.343921927192241e-8, 0.000025082830688916147, 2.194749129103002e-7, 0.000007508597263949923, 0.0000015960250721036573, 2.5857605123746907e-7, 1.9372785597937536e-9, 0.0000019057885083384463, 0.0000017129677871707827, 7.323390605051827e-7, 0.000005009815140510909, 0.000003121077043033438, 0.0000034678289466683054, 6.46155295935813e-10, 0.000011728605386451818, 0.0006845314055681229, 0.0004808211815543473, 0.00002371838672843296, 0.000007486389222322032, 0.000007460118922608672, 0.0003016941773239523, 0.0000014983462506279466, 3.893206468319477e-8, 0.000003907889094989514, 0.00003497596480883658, 0.0005694731371477246, 1.7635809967941896e-7, 3.1200636385619873e-7, 1.240557310211443e-7, 4.747210979871852e-8, 0.0000015149446426221402, 0.000017691450921120122, 0.00003621419455157593, 5.221862764415164e-8, 4.2445428505288874e-8, 1.1805924016172753e-9, 0.005626885686069727, 0.00003336576992296614, 4.752487847703435e-10, 0.0000562373643333558, 2.129764098413034e-8, 5.264745794875125e-8, 0.0000010043719385066652, 2.3112716185380577e-9, 3.7609891023748787e-7, 0.00000115226941943547, 7.171418303641985e-8, 0.000013841569852957036, 0.000009874836905510165, 8.641044324519953e-9, 1.195948584609141e-7, 2.785533803617568e-9, 2.8058180223666795e-9, 6.288394249764906e-9, 8.57198401149617e-9, 0.0000030448723009612877, 0.00003031481901416555, 0.000002703938207559986, 0.00003078205190831795, 9.331846406723798e-10, 0.000018318361981073394, 2.4292695632865957e-10, 8.118396266354466e-8, 7.746661481178307e-7, 1.6477966369166097e-7, 8.437586740406289e-10, 4.2769048719248914e-11, 2.3230721790667985e-9, 8.251655003732594e-8, 0.000021678664779756218, 4.471499437386228e-8, 0.17504729330539703, 6.281609454816817e-9, 0.000002235674173789448, 0.000002054448032140499, 0.000001932413852046011, 0.0000016931240907069878, 6.400025648334307e-11, 5.732947894188101e-9, 3.5939260101258697e-7, 6.915166039789256e-8, 3.03327862827274e-10, 1.8067875320881832e-11, 4.415480481245737e-11, 3.6632979635853324e-12, 1.5353945892471188e-10, 2.4290841560414833e-10, 1.953231743012651e-10, 2.3470440868589293e-11, 1.3828879447813636e-12, 1.5955433155245835e-11, 5.330600960640197e-10, 3.9310335542275254e-10, 3.4322450659374226e-8, 0.027489984408020973, 0.01029787678271532, 0.061678461730480194, 0.002520942594856024, 0.00007164949056459591, 6.859346424192836e-9, 0.00001952238380908966, 2.2411517086595723e-10, 3.078891364083347e-9, 8.257208250483927e-9, 1.2933092097267007e-10, 7.684909653082883e-11, 7.742669083654619e-8, 1.4669755188378986e-8, 1.7132053642399114e-7, 0.000006076161298551597, 4.925601038152649e-10, 1.4974969531067472e-7, 0.0000055506720855191816, 7.286835579378703e-9, 2.283947919679008e-9, 0.00009980044706026092, 2.6694192456488963e-7, 5.764510433436953e-7, 0.00041232851799577475, 0.00007137696229619905, 0.000012840313502238132, 1.1793984810992697e-7, 0.000005098384463053662, 3.544358166338024e-12, 4.0957539551751687e-13, 0.7122098803520203, 1.096618085227874e-8, 1.2963921047770555e-9, 5.613841058682567e-10, 1.2059825360566379e-9, 5.288656623747556e-9, 1.2682308328515468e-11, 8.474383521306361e-12, 9.460036087816093e-10, 3.0644525111922505e-11, 0.000008070990588748828, 3.848583318699639e-8, 8.388415656535031e-11, 6.66081165917598e-12, 5.676893330419652e-11, 3.922433558511962e-11, 1.0048153715330743e-12, 4.379984708258178e-10, 5.44444038463876e-11, 1.2431928316652963e-12, 4.3703856505983296e-11, 3.67491497302308e-12, 1.1813987566000606e-9, 3.3752920597374114e-11, 9.566136077721055e-12, 3.383305580140217e-10, 1.0292429235281286e-11, 9.648172885623474e-12, 3.6334958508632553e-7, 4.2000278255294177e-10, 2.9818980618046e-10, 1.2163400242570788e-7, 0.000002865820988517953, 1.1990112028237299e-11, 8.813688112674356e-10, 1.1497139351668295e-10, 2.7324265072792286e-10, 3.885617516630191e-8, 6.343247455076195e-11, 1.1135421751351515e-10, 3.389848679535845e-10, 0.0000013870950397176784, 1.9523248795394466e-8, 3.1540010186903444e-11, 2.000729998341555e-10, 6.31417085283914e-10, 6.132015034632232e-12, 0.000050130194722441956, 1.7424610643246297e-9, 8.75391859694874e-12, 1.5106949025067706e-9, 2.0486821128429256e-8, 2.929064102374923e-9, 1.604071186989131e-8, 1.9116142002673087e-9, 3.312989119153009e-11, 0.000002707902012843988, 7.089162156609374e-13, 4.1470896161577286e-11, 9.2300131981915e-9, 5.905586242249683e-9, 8.289174346920447e-10, 7.003118224213623e-11, 4.2394815435997657e-10, 1.7795981355206436e-10, 0.000002496192564649391, 8.072198198760816e-8, 1.1755798112744742e-8, 1.0419590523724764e-8, 1.180140998258139e-7, 0.00003605161691666581, 3.3121532860141967e-12, 6.206528624375096e-10, 3.268035286829729e-10, 5.3892793006049544e-11, 5.037623651560352e-9, 0.000004331988293415634, 3.018586047787153e-9, 8.130342753209785e-12, 2.0267315603561542e-11, 9.819737904759318e-12, 1.0164450878202835e-11, 3.314166441281685e-10, 3.958268166570633e-7, 1.1742705696704547e-9, 5.529278424010187e-12, 3.5741045678605587e-9, 6.243585093379522e-10, 2.2291997581191936e-8, 1.0736971728375622e-10, 6.319770401441716e-11, 0.0000021425641989480937, 1.0068781745864452e-11, 2.0059456873333659e-10, 9.628021047092261e-9, 2.0658814936513892e-11, 4.180473300863241e-9, 4.093985220277041e-11, 2.7821872583544405e-10, 9.255543380326525e-12, 0.0000013490035826180247, 1.971971919090265e-9, 5.458582563733216e-7, 2.8131779891693576e-11, 2.0715922033343048e-10, 1.5851441253350584e-12, 3.5813123300254546e-12, 1.3202635429365728e-8, 8.652179667167914e-12, 4.2741081074382237e-7, 3.7099490146630387e-10, 7.06558438423599e-8, 9.648343235468815e-11, 6.496301570681554e-14, 4.9370008081695e-10, 9.926633959267406e-10, 1.4368040091028433e-10, 6.297270260802179e-7, 4.831603450661248e-10, 1.0474292366779991e-7, 1.6250416567942239e-9, 0.000024217810278059915, 2.30627577479936e-7, 6.419081412245564e-12, 1.2820641900543328e-12, 4.52350903401566e-8, 7.439723143098931e-11, 9.71776305258576e-12, 9.509596310408597e-8, 1.5753748305868953e-9, 1.843418126479257e-11, 8.743427509783075e-11, 1.1755926232481784e-9, 8.699093001496294e-8, 3.9812728114263507e-10, 1.2599813414837513e-9, 1.978183838957648e-9, 3.3259859710116357e-12, 1.9450257376929514e-11, 4.04427713540656e-10, 9.53514156520896e-10, 1.1534705413041024e-9, 2.884962269078528e-9, 3.1039601822158147e-7, 2.697875700619079e-9, 7.79935938055587e-9, 7.421819958608467e-8, 0.000004636636731447652, 2.4712067461796217e-11, 4.688048560463898e-12, 2.273747767844725e-8, 4.744840978454512e-11, 0.000003190389861629228, 3.144880406438788e-12, 2.712228219792223e-10, 1.6377191158767346e-8, 9.324459711024247e-7, 2.1443204850646325e-11, 2.5156179361829345e-9, 1.8102656873519862e-10, 4.4552702456110427e-13, 8.023327835449123e-11, 1.3444300783760355e-8, 1.9768993733682017e-11, 4.625780036793259e-10, 1.6013903092471082e-8, 2.5904644748719896e-11, 5.744935777096671e-12, 1.4746494303441438e-10, 1.7657761364198166e-10, 6.303413901953547e-10, 3.423846206551673e-10, 2.72494382613786e-9, 3.0990245092343827e-12, 1.9349860255757356e-12, 1.2022907469599886e-7, 1.2300429563794069e-9, 4.291767028569149e-12, 5.607136283058978e-12, 5.024916038820493e-10, 9.711824677793857e-10, 5.52032697331839e-10, 5.353419096909562e-12, 2.1947594852633756e-9, 1.0791332237525264e-11, 3.2427923457589714e-8, 7.452953185160816e-13, 5.481652909367085e-10, 1.4852241658758203e-9, 1.1333900831744792e-11, 1.3395040632246946e-10, 1.0129484057097571e-10, 1.0646971151939688e-11, 1.7703905008659149e-9, 3.1282788859332555e-12, 7.005172619756195e-8, 3.0423610679342072e-12, 0.0000020430143194971606, 2.8422849851494902e-8, 4.600311884900288e-12, 1.8224310949221945e-8, 0.0000019336821424076334, 1.7589868450684776e-9, 1.9949011331732436e-9, 2.2534987209610335e-8, 2.9576503468575766e-9, 2.7877768982165207e-9, 4.3757887938089546e-12, 4.138303241751906e-11, 1.3785448338410333e-9, 4.403904758226718e-12, 1.2111565222960863e-11, 3.56043244664761e-7, 5.224193699859825e-8, 2.0286458277118946e-11, 2.267554499724156e-8, 1.5387162377589192e-10, 4.5694989458944235e-10, 1.2388730930013025e-8, 6.189968981828997e-9, 4.632741672921936e-12, 2.9409541468794487e-9, 4.1784516818799133e-11, 1.053467816453102e-11, 7.148639724618988e-8, 5.388615985715828e-13, 6.217945269781922e-8, 3.292540892707585e-11, 7.705218407760839e-12, 3.63891778931702e-8, 1.5686217602617347e-10, 1.6867884866655913e-8, 9.996755778729494e-8, 0.000003907777227141196, 1.1768551411162065e-10, 0.00006840402784291655, 9.35360944254171e-9, 5.244107814661447e-9, 6.148508091552429e-11, 1.103818103587173e-8, 2.6776771446836156e-13, 2.984587577081754e-11, 2.1748768064266955e-10, 4.713314374210631e-12, 3.391163350130455e-9, 7.12820913406631e-10, 2.113594490538162e-7, 7.450540184805732e-12, 5.234562228118023e-10, 5.748317932763314e-10, 1.978070596209136e-9, 4.221890337330336e-10, 2.565163012557825e-11, 1.949946497672994e-12, 2.832731382795828e-9, 3.05584604929493e-13, 1.3135619703064094e-8, 7.283212966058272e-8, 1.2448271302645253e-9, 3.5858010896498704e-13, 6.941711649943727e-9, 2.001602261714197e-8, 7.164236651840961e-13, 1.2701507046131155e-7, 3.5962863242922083e-10, 1.5264206565390737e-11, 3.2076528100333235e-9, 2.3620076380903576e-11, 7.758771403132414e-11, 3.336577758875081e-12, 1.2107268312910868e-11, 5.101864530843159e-7, 4.3258033266546647e-10, 6.286684367529105e-11, 1.352925882219455e-13, 3.116593205731988e-9, 1.1785549966503162e-11, 9.501238906750586e-8, 9.142010065632533e-12, 3.46550094176834e-10, 9.952948465397071e-10, 8.769556261722933e-13, 2.4107863275113495e-11, 5.238736666690613e-10, 1.0780958374298488e-12, 2.2885811301609493e-11, 0.00002410623710602522, 0.000007993623512447812, 5.392549254357171e-11, 4.984532964158461e-8, 6.203603106769151e-7, 1.1287680790061927e-9, 9.435667525092839e-11, 0.000001515733742962766, 0.0000017070674402930308, 6.312379952078118e-9, 4.594496338938825e-9, 2.9189681227670405e-10, 9.920334952812082e-13, 3.2775939740048443e-9, 1.6134975300285959e-12, 2.642697172205999e-10, 4.6526948960234904e-11, 1.4449828833473788e-10, 3.2264194788078626e-11, 3.627166904607293e-7, 3.585314267695594e-10, 2.3162957663025452e-11, 1.8892793107738726e-8, 0.00001149287163570989, 1.464487905944445e-11, 3.4905082296754486e-11, 8.20483592178789e-9, 0.00009694286563899368, 1.1426700557981562e-10, 1.8334158635724407e-9, 2.4157982281280965e-8, 1.2080851874429754e-8, 6.470330521368695e-11, 1.5025666474932642e-11, 8.013452124089326e-10, 1.6602545727106843e-11, 6.471102764749048e-9, 1.5367321637427267e-8, 8.900660652955139e-9, 2.1128354177335495e-8, 2.1680202522134095e-8, 2.350639460857451e-9, 1.680395579628513e-11, 0.00000486115595776937, 1.4987676898170488e-12, 1.9295398612229064e-11, 2.0537212819249362e-8, 8.181796351536264e-10, 7.655917011462066e-10, 0.0000674232142046094, 1.6568384353377041e-7, 4.351966703675103e-12, 5.018244664256599e-8, 9.038518197779233e-12, 2.894455855551037e-11, 6.784393917769194e-7, 6.152335862985581e-10, 5.669283185266716e-12, 6.253301876313344e-9, 6.616724529395768e-11, 2.020877909458818e-9, 5.810280642032373e-13, 1.5744076042878419e-9, 5.903597749545852e-11, 1.01135142926978e-7, 1.2164188945007481e-7, 1.1042390959947745e-12, 6.720439205132323e-10, 1.313960919235857e-11, 8.052073212638788e-7, 8.358772701777539e-11, 2.2157047030457733e-10, 2.1157589569220647e-12, 1.1424123799730346e-11, 2.140300853215038e-10, 9.143121815213817e-9, 0.0000013994654182170052, 1.9623955238579072e-10, 1.2131904638876256e-12, 1.165341156905697e-9, 1.115385672711966e-9, 4.67415395277726e-9, 3.035684897900737e-11, 2.4340312751447435e-11, 5.257871395214497e-12, 2.5201754016990208e-9, 2.7368168495356393e-11, 2.9249232369465972e-8, 0.00010990325972670689, 1.2986895114863728e-8, 7.084401953960651e-10, 7.759585335387342e-11, 2.6377897199836298e-8, 3.0726522021184977e-11, 0.000002303313976881327, 1.3105726226481096e-10, 9.49178854625643e-7, 1.6110728029428145e-10, 5.051357943042234e-11, 8.894335223885719e-8, 0.000053102474339539185, 1.249006974235467e-11, 5.193704494255158e-11, 1.0486269491627453e-10, 1.9373698478819534e-10, 2.3732242837581907e-8, 3.2130076377256955e-11, 1.0186789779764727e-11, 5.30614385763073e-10, 2.7192976403966895e-7, 7.549603964207563e-8, 7.392155794150312e-7, 9.332723927002462e-9, 7.991742684287928e-11, 1.2449785646850842e-10, 6.623849246878422e-10, 8.26917839757968e-11, 1.2671333138314367e-7, 1.6254393386816446e-8, 5.0056786493613e-10, 4.7542719761040075e-11, 1.8095158793585142e-7, 3.9684749930657404e-10, 1.1074124256493789e-10, 1.579498416504066e-7, 2.168204088492942e-10, 4.394346220237821e-9, 2.3591048559090666e-10, 4.0389922309480575e-12, 1.0280598421175124e-11, 1.580301970012521e-12, 4.807232016901253e-7, 2.242701846455475e-8, 3.2486653367413965e-9, 9.792919947182455e-11, 2.3497608303557627e-9, 9.725052052544925e-8, 6.786160078320336e-9, 2.451101579481474e-7, 6.6696596162652e-12, 2.438939077364921e-7, 1.3661032027822984e-10, 2.3005060967307145e-8, 1.0132256811345997e-8, 5.073532739763298e-13, 5.679378745071517e-9, 1.2499001833532475e-8, 2.761147144259013e-10, 2.141625852353224e-12, 2.606367162025225e-12, 3.3718482228550783e-8, 2.7616937359198346e-7, 2.5736732744974233e-9, 3.6894743260518226e-8, 7.386647959961579e-10, 1.8418228364680544e-7, 4.10858985722129e-11, 1.2950166980441047e-11, 2.5173349516016685e-10, 8.938283446724427e-11, 2.6977586831122835e-12, 8.34746161082478e-11, 1.147462458384041e-9, 9.116061683300813e-9, 1.343394551156507e-8, 4.0360799147265425e-9, 4.837795095080644e-12, 4.82539405766147e-7, 7.79595321631632e-9, 3.4332465256164957e-12, 1.8496045806060124e-9, 2.764184792169999e-8, 0.000004120065568713471, 2.903708384849324e-10, 2.5650502555318866e-11, 6.923011608428453e-10, 5.355163423814702e-9, 0.00005068378959549591, 1.0378230497209984e-9, 0.00003075188578804955, 1.0585723270173375e-10, 5.979544984158203e-12, 0.0000022632834770774934, 3.160204875563011e-10, 3.090885533629795e-11, 1.5330389735446204e-10, 3.384238311809895e-8, 1.1056401350018064e-9, 1.1006419953218938e-7, 8.430849796070561e-9, 7.266893684021447e-12, 3.8625754070903406e-13, 1.3226082273831707e-7, 1.0329466448855129e-10, 1.0756445040227547e-10, 3.5724827540661863e-9, 2.551235915235206e-12, 2.6431421495942686e-9, 3.009795375170238e-13, 6.39417763181882e-8, 9.743844620047071e-11, 1.7634073997026267e-13, 2.167107292228021e-11, 1.6370016453493008e-7, 1.0263357004547391e-11, 3.793202640878235e-9, 5.807816023661871e-7, 9.671780043518652e-11, 1.6287428350469924e-10, 1.3474400761825933e-10, 8.265122630746191e-8, 3.39546557537318e-10, 0.000001276438979402883, 2.989293534927384e-11, 3.4548453507754484e-12, 1.3720293347632695e-12, 1.3019073319409102e-10, 2.3646368196850176e-10, 3.1718700582716863e-11, 1.7763027715389512e-9, 3.375158486029761e-10, 2.2086772515084174e-12, 2.700299150948382e-10, 4.568399560866965e-7, 2.522115778447187e-7, 0.0000015563140323138214, 2.486164341064523e-8, 9.834174446998745e-11, 2.690192513199463e-10, 3.0369767500815215e-7, 7.12726100360328e-9, 0.00008517859532730654, 7.500198684340376e-9, 2.966143997085169e-11, 4.5965649064783065e-9, 7.376000504821789e-11, 1.2932858339809172e-8, 0.00002438955743855331, 1.6528834123619163e-7, 0.0000014316175338535686, 6.286574125852207e-12, 5.067156750074818e-14, 3.7068595805725413e-13, 3.619217991968071e-8, 5.639006483981746e-10, 9.056915928340459e-8, 1.462930748763469e-10, 8.25235821518e-13, 7.520278288986049e-10, 1.5911321149530977e-9, 3.296793948948107e-8, 1.4336819731397554e-8, 7.274827140690832e-8, 1.7790168643783133e-11, 1.333188004437602e-10, 4.749732829267828e-10, 0.00027424388099461794, 5.306377004465901e-10, 1.8853103800342552e-10, 3.131711686851779e-12, 3.021751251996996e-11, 2.358737205554462e-9, 4.3320973475147184e-9, 2.0026848235321637e-10, 0.0000555994629394263, 6.365068916380778e-9, 1.830544604786155e-8, 1.0285393647890828e-9, 5.6285160560110015e-11, 3.5228453043600894e-8, 1.841626016130249e-7, 5.215748277720422e-9, 3.520469533668802e-7, 1.686192629968275e-9, 0.000027082855012849905, 0.000003304610117993434, 3.8863458939886186e-7, 0.00000389463639294263, 2.5827043259596394e-7, 0.000015117241673578974, 1.7344915193007182e-7, 8.131805770972278e-7, 1.346104200328213e-10, 1.6013207471132773e-7, 1.9429153397254595e-8, 2.8232179261067358e-8, 6.6226551152792634e-12, 4.574805378271263e-12, 5.558415949735718e-10, 2.42216302570597e-10, 1.97446239913468e-10, 2.0345748907857342e-7, 9.127479927428794e-8, 2.1612727163500267e-9, 2.1285720408492637e-10, 0.0000013442161161947297, 3.1444056247664776e-9, 1.854064540784961e-10, 0.000002472174855938647, 7.825677605932668e-12, 8.488109659587906e-10, 2.856030967279821e-10, 3.3829877565949573e-7, 2.5352476194784312e-12, 6.057065266018569e-11, 2.093064166430736e-9, 7.038866559928858e-13, 1.3099878126698883e-10, 2.2307415636912964e-10, 7.244440047848855e-10, 1.3959929132806304e-12, 3.9929216200107476e-7, 0.000006444175141950836, 1.346656397505086e-10, 0.00012225077080074698, 5.383495818023221e-7, 3.4439128171470657e-7, 0.000003209426267858362, 6.363997107072805e-10, 4.815534992985704e-8, 3.909437357174639e-11, 3.680469262690167e-9, 2.3815358574097445e-8, 1.7666470952804048e-8, 1.1924219833758798e-8, 0.0003670523874461651, 5.345963813851995e-7,
    ];

    const type1 = {type: nn.FLOAT32};
    const type0 = {type: nn.TENSOR_FLOAT32, dimensions: [1, 1, 1, 1000]};
    const type0_length = product(type0.dimensions);

    const input = operandIndex++;
    model.addOperand(type0);
    const beta = operandIndex++;
    model.addOperand(type1);
    const output = operandIndex++;
    model.addOperand(type0);

    model.setOperandValue(beta, new Float32Array([1.0]));
    model.addOperation(nn.SOFTMAX, [input, beta], [output]);

    model.identifyInputsAndOutputs([input], [output]);
    await model.finish();

    const compilation = await model.createCompilation();
    compilation.setPreference(getPreferenceCode(options.prefer));
    await compilation.finish();

    const execution = await compilation.createExecution();

    const input_input = new Float32Array(input_value);
    execution.setInput(0, input_input);

    const output_output = new Float32Array(type0_length);
    execution.setOutput(0, output_output);

    await execution.startCompute();

    for (let i = 0; i < type0_length; ++i) {
      assert.isTrue(almostEqualCTS(output_output[i], output_expect[i]));
    }
  });
});
